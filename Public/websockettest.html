<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>Pro socket boisssss</title>
		<script>
			function createRoom() {
			  var xhttp = new XMLHttpRequest();
			  xhttp.onreadystatechange = function() {
			    if (this.readyState == 4 && this.status == 200) {
				  var sessionId = JSON.parse(this.responseText).id;
				  document.getElementById("joinRoomCode").value = sessionId;
				  
				  document.getElementById("updates").innerHTML += this.responseText + "\n";
			    }
			  };
			  xhttp.open("POST", "http://localhost:8080/create", true);
			  xhttp.setRequestHeader("Content-type", "application/json");
			  xhttp.send();
			}	
			
			function joinRoom() {
				var text = document.getElementById("joinRoomCode").value;
				var socket = new WebSocket('ws://localhost:8080/join/' + text);  
				socket.onmessage = function (event) {
					document.getElementById("updates").innerHTML += "event: " + event.data + "\n";
				};
			}
			
			function updateRoom() {
			  var xhttp = new XMLHttpRequest();
			  xhttp.onreadystatechange = function() {
			    if (this.readyState == 4 && this.status == 200) {
				  document.getElementById("updates").innerHTML += this.responseText + "\n";
			    }
			  };
			  var obj = Object();
			  obj.update = Object();
			  obj.update.user = 0;
			  obj.update.updateType = 0;
			  
			  var text = document.getElementById("joinRoomCode").value;
			  xhttp.open("POST", "http://localhost:8080/update/" + text, true);
		      xhttp.setRequestHeader("Content-type", "application/json");
			  xhttp.send(JSON.stringify(obj));
			}
		</script>
	</head>
	<body>
		<div>
		<button type="button" onclick="createRoom()">Create Room</button>
		</div>
		<div>
		<input id="joinRoomCode"></input>
		</div>
		<div>
		<button type="button" onclick="joinRoom()">Join Room</button>
		</div>
		<div>
		<button type="button" onclick="updateRoom()">Update Room</button>
		</div>
		<div>
		<textarea id="updates" rows="10" cols="50"></textarea>
		</div>
	</body>
</html>